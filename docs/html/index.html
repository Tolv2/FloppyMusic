<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FloppyMusic library: FloppyMusic - Musical Floppy Disk Drive &#39;library&#39;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FloppyMusic library<span id="projectnumber">&#160;v0.1</span>
   </div>
   <div id="projectbrief">A simple library to control Floppy Disk Drives in a way that plays music</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">FloppyMusic - Musical Floppy Disk Drive 'library' </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<p>This project aims to create a small library that makes it easier to control a given number of FDDs (which I will refer to as floppies) in such a way that they produce a certain note when told to do so. This is done by pulsing the floppies' STEP and DRIVE ENABLE pins logically true (usually LOW) at exactly the right frequency. This library is able to manage multiple floppies at once by spawning a new thread for each one.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Dependencies</h1>
<p>The library itself is written in pure C and has no dependencies, other than a POSIX thread compliant system and C compiler (-pthreads). However, it integrates very well with MIDI libraries such as <a href="https://github.com/PortMidi/portmidi">PortMidi</a> or <a href="https://github.com/MarquisdeGeek/midilib">Midilib</a>, because the library does have the capabilities to handle MIDI messages, under certain conditions. See the examples for more details.</p>
<p>The dependencies for the examples are listed in their own READMEs.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Usage</h1>
<p>Generally, the workflow should look like this:</p>
<ol type="1">
<li>Initialize the library with a call to FM_Init</li>
<li>Create and fill correct <a class="el" href="structFM__FloppyInfo.html" title="A struct representing a physical floppy device and how to interface with it.">FM_FloppyInfo</a> structs that contain all the nescessary information in order to drive the floppy correctly. This includes mapping all the pins, but also providing a write function that will set a certain pin to true or false with the signature void(int, bool) (see examples)</li>
<li>Create (but do not nescesarily fill) <a class="el" href="structFM__Floppy.html" title="A struct representing a floppy device managed by the library.">FM_Floppy</a> structs that will serve as a handle.</li>
<li>Register the floppies to the library by either calling <a class="el" href="FM__Floppy_8c.html#a00f1ccd02f673accc92aabef7715669b" title="Helper function that assigns the FM_FloppyInfo object to the FM_Floppy object, and then registers it.">FM_RegisterFloppyFromInfo()</a>, or filling the <a class="el" href="structFM__Floppy.html" title="A struct representing a floppy device managed by the library.">FM_Floppy</a> struct manually and then calling <a class="el" href="FM__Floppy_8c.html#aa8d67053681a46ef4cac11eb3f5b1758" title="Used internally, but can be used externally.">FM_RegisterFloppy()</a></li>
<li>Choose between 'Automatic' or 'MIDI' managment mode [^1].<ul>
<li>Under Automatic mode, in the main loop, pass on the <em>period in nanoseconds(!)</em> of the sound you wish to play on to the <a class="el" href="FM__Auto_8c.html#a4c6fadcadae11aee6414ed0fb0c3fa5c" title="Start playing a sound using Automatic managment mode.">FM_Auto_StartPlayingSound()</a> when you wish to start playing the node and the same value to <a class="el" href="FM__Auto_8c.html#a485220e30943665c3bc33f8a8af38538" title="Stop playing a sound previously started by a call to FM_AutoStartPlayingSound.">FM_Auto_StopPlayingSound()</a> when you wish to stop playing it. Note that this library includes a precalculated array that serves as a map of MIDI notes to these periods, where the index of the MIDI note corresponds to the index in the array. It's called FM_MIDI_NoteMap, declared in <a class="el" href="FM__MIDI_8h.html">FM_MIDI.h</a>.</li>
<li>Under MIDI mode, simply pass the 32 bit MIDI message word on to <a class="el" href="FM__MIDI_8c.html#a074b649c24ed2bd501b3a7559bd2d25d" title="Handle a MIDI message in MIDI managment mode.">FM_MIDI_HandleMessage()</a>, This will handle NoteOn and NoteOff messages for you. Notably, MIDI libraries often let you access this 32 bit word, and you can simply pass it on (for example PortMidi PmMessage messages are directly compatible).</li>
</ul>
</li>
<li>After the user chooses to exit, call <a class="el" href="FloppyMusic_8c.html#a384e52e956ae07b030525b36f6d8932d" title="Library deinitialization function.">FM_Deinit()</a> to free allocated resources.</li>
</ol>
<p>[^1] This choice isn't enforced, you can mix and match calls to the functions from the different submodules, but this is not reccommended. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
